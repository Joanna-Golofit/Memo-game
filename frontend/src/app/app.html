<div class="memory-game">
  <!-- NOWY: Selektor kategorii -->
  <div class="category-selector">
    <h3>Wybierz kategorię:</h3>
    <div class="category-buttons">
      @for (category of availableCategories(); track category.id) {
        <button 
          class="category-btn"
          [class.active]="selectedCategory() === category.id"
          (click)="onCategoryChange(category.id)">
          <span class="category-icon">{{category.icon}}</span>
          <span class="category-name">{{category.name}}</span>
        </button>
      }
    </div>
  </div>

  <!-- Nagłówek gry - BEZ dynamicznych elementów -->
  <header class="game-header">
    <h1 class="game-title">{{ title() }}</h1>
  </header>

  <!-- Główna sekcja gry -->
  <main class="game-main">
    <!-- Panel gracza po lewej - Inka -->
    <div class="player-panel left-player" [class.active]="currentPlayer() === 0 && gamePhase() === 'playing'">
      <div class="player-name">Inka</div>
      <div class="score">🏆 {{ player1Score() }}</div>
    </div>

    <!-- Plansza gry -->
    <div class="game-board">
      @for (card of cards(); track card.position) {
        <div 
          class="card"
          [class.flipped]="card.isFlipped || gamePhase() === 'preview'"
          [class.matched]="card.isMatched"
          (click)="onCardClick(card)">
          
          <div class="card-back">
            <span class="card-text">?</span>
          </div>
          
          <div class="card-front">
            <img 
              [src]="getImageUrl(card)" 
              [alt]="card.name"
              class="card-image">
            <span class="card-name">{{card.name}}</span>
          </div>
        </div>
      }
    </div>

    <!-- Panel gracza po prawej - Natan -->
    <div class="player-panel right-player" [class.active]="currentPlayer() === 1 && gamePhase() === 'playing'">
      <div class="player-name">Natan</div>
      <div class="score">🏆 {{ player2Score() }}</div>
    </div>
  </main>

  <!-- Przycisk restart -->
  <footer class="game-footer">
    <button 
      class="restart-btn"
      (click)="onRestartClick()"
      [class.pulse]="isGameFinished()"
    >
      <span *ngIf="isGameFinished()">🎉 Zagraj ponownie</span>
      <span *ngIf="!isGameFinished() && hasNoMatchedCards()">🔄 Nowe karty</span>
      <span *ngIf="!isGameFinished() && !hasNoMatchedCards()">🔄 Restart gry</span>
    </button>
  </footer>

  <!-- OVERLAY MESSAGES - nie wpływają na layout -->
  
  <!-- Preview countdown - NA DOLE -->
  <div class="overlay-message bottom-overlay" *ngIf="gamePhase() === 'preview'">
    <div class="preview-message">
      ⏱️ Zapamiętaj gdzie są pary! {{ previewTimeLeft() }}
    </div>
  </div>
  
  <!-- Gratulacje - NAD PLANSZĄ -->
  <div class="overlay-message center-overlay" *ngIf="isGameFinished()">
    <div class="finish-message">
      🎉 Gratulacje!<br>
      <span *ngIf="player1Score() > player2Score()">🏆 Wygrywa Inka!</span>
      <span *ngIf="player2Score() > player1Score()">🏆 Wygrywa Natan!</span>
      <span *ngIf="player1Score() === player2Score()">🤝 Remis!</span>
    </div>
  </div>

  <!-- Dialog restart -->
  <div class="restart-overlay" *ngIf="showRestartConfirm()">
    <div class="restart-dialog">
      <h3>🤔 Na pewno chcesz zacząć od nowa?</h3>
      <p>Stracisz obecny postęp w grze!</p>
      <div class="dialog-buttons">
        <button class="btn-cancel" (click)="cancelRestart()">
          ❌ Nie, graj dalej
        </button>
        <button class="btn-confirm" (click)="confirmRestart()">
          ✅ Tak, zacznij od nowa
        </button>
      </div>
    </div>
  </div>
</div>